<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Home</title>
<meta name="keywords" content="">
<meta name="description" content="1. 图像投影模型与3D重建理论
1.1. $SLAM$的概念

$SLAM$（Simultaneous Localization and Mapping，即同步定位与地图构建）。
通过估计每个相机的位置和场景的三维点，实现对场景的重建。

1.2. 逆向二维图像
从二维图像中提取三维场景的信息，即进行$3D$重建
逆向投影

图像是三维场景经过投影后的二维表示，要恢复三维信息，需要逆转这个投影过程。
建立一个数学模型，描述三维场景如何投影到二维图像中，然后尝试逆向求解。

1.3 针孔相机模型（Modèle Sténopé）
1.3.1 模型概述

定义：针孔相机模型假设所有的光线都通过一个公共点，即光心（光学中心）。
优点：模型简单，易于逆向计算，在三维重建中广泛使用。

1.3.2 坐标系和符号约定

摄像机坐标系：

原点 $O_C$：光学中心，坐标为 $(0, 0, 0)$。
轴方向：建立右手坐标系，$X_C$ 向右，$Y_C$ 向下，$Z_C$ 指向后方（场景深度方向）。
优势：$Z$ 轴指向后方，物体深度为正，符合直觉。



1.3.3 三维点的投影到归一化焦平面

三维点表示：

点 $U$：坐标为 $(U_X, U_Y, U_Z)$，表示空间中的一个三维点。


归一化焦平面：

一个与光心 $O_C$ 距离为 $1$ 的平面（$Z_C = 1$），称为归一化聚焦平面。
将远处的三维点投影到此平面上。



1.3.4 齐次坐标与非齐次坐标
齐次坐标（Homogeneous Coordinates）：

定义：在原有坐标后增加一个维度（通常为 $1$），方便表示投影和变换。
表示：对于二维点 $m = (m_X, m_Y)^\top$，其齐次坐标为 $\bar{m} = (m_X, m_Y, 1)^\top$

作用：齐次坐标方便矩阵运算，尤其是在投影和变换过程中。">
<meta name="author" content="Zehua">
<link rel="canonical" href="http://localhost:1313/posts/signal_cn/3d%E9%87%8D%E5%BB%BA%E7%90%86%E8%AE%BA/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.1b02b89634cb203c0adb2529fde6c2ef5d9909695eb3a05043bdefba6e2b892b.css" integrity="sha256-GwK4ljTLIDwK2yUp/ebC712ZCWles6BQQ73vum4riSs=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/signal_cn/3d%E9%87%8D%E5%BB%BA%E7%90%86%E8%AE%BA/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"
    integrity="sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"
    integrity="sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx"
    crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js"
    integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR"
    crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
            
            
            delimiters: [
                { left: '$$', right: '$$', display: true },
                { left: '$', right: '$', display: false },
                { left: '\\(', right: '\\)', display: false },
                { left: '\\[', right: '\\]', display: true }
            ],
            
            throwOnError: false
        });
    }); 
</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet"><meta property="og:title" content="" />
<meta property="og:description" content="1. 图像投影模型与3D重建理论
1.1. $SLAM$的概念

$SLAM$（Simultaneous Localization and Mapping，即同步定位与地图构建）。
通过估计每个相机的位置和场景的三维点，实现对场景的重建。

1.2. 逆向二维图像
从二维图像中提取三维场景的信息，即进行$3D$重建
逆向投影

图像是三维场景经过投影后的二维表示，要恢复三维信息，需要逆转这个投影过程。
建立一个数学模型，描述三维场景如何投影到二维图像中，然后尝试逆向求解。

1.3 针孔相机模型（Modèle Sténopé）
1.3.1 模型概述

定义：针孔相机模型假设所有的光线都通过一个公共点，即光心（光学中心）。
优点：模型简单，易于逆向计算，在三维重建中广泛使用。

1.3.2 坐标系和符号约定

摄像机坐标系：

原点 $O_C$：光学中心，坐标为 $(0, 0, 0)$。
轴方向：建立右手坐标系，$X_C$ 向右，$Y_C$ 向下，$Z_C$ 指向后方（场景深度方向）。
优势：$Z$ 轴指向后方，物体深度为正，符合直觉。



1.3.3 三维点的投影到归一化焦平面

三维点表示：

点 $U$：坐标为 $(U_X, U_Y, U_Z)$，表示空间中的一个三维点。


归一化焦平面：

一个与光心 $O_C$ 距离为 $1$ 的平面（$Z_C = 1$），称为归一化聚焦平面。
将远处的三维点投影到此平面上。



1.3.4 齐次坐标与非齐次坐标
齐次坐标（Homogeneous Coordinates）：

定义：在原有坐标后增加一个维度（通常为 $1$），方便表示投影和变换。
表示：对于二维点 $m = (m_X, m_Y)^\top$，其齐次坐标为 $\bar{m} = (m_X, m_Y, 1)^\top$

作用：齐次坐标方便矩阵运算，尤其是在投影和变换过程中。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/signal_cn/3d%E9%87%8D%E5%BB%BA%E7%90%86%E8%AE%BA/" />
<meta property="og:image" content="http://localhost:1313/images/papermod-cover.png" />
<meta property="article:section" content="posts" />



<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://localhost:1313/images/papermod-cover.png" />
<meta name="twitter:title" content=""/>
<meta name="twitter:description" content="1. 图像投影模型与3D重建理论
1.1. $SLAM$的概念

$SLAM$（Simultaneous Localization and Mapping，即同步定位与地图构建）。
通过估计每个相机的位置和场景的三维点，实现对场景的重建。

1.2. 逆向二维图像
从二维图像中提取三维场景的信息，即进行$3D$重建
逆向投影

图像是三维场景经过投影后的二维表示，要恢复三维信息，需要逆转这个投影过程。
建立一个数学模型，描述三维场景如何投影到二维图像中，然后尝试逆向求解。

1.3 针孔相机模型（Modèle Sténopé）
1.3.1 模型概述

定义：针孔相机模型假设所有的光线都通过一个公共点，即光心（光学中心）。
优点：模型简单，易于逆向计算，在三维重建中广泛使用。

1.3.2 坐标系和符号约定

摄像机坐标系：

原点 $O_C$：光学中心，坐标为 $(0, 0, 0)$。
轴方向：建立右手坐标系，$X_C$ 向右，$Y_C$ 向下，$Z_C$ 指向后方（场景深度方向）。
优势：$Z$ 轴指向后方，物体深度为正，符合直觉。



1.3.3 三维点的投影到归一化焦平面

三维点表示：

点 $U$：坐标为 $(U_X, U_Y, U_Z)$，表示空间中的一个三维点。


归一化焦平面：

一个与光心 $O_C$ 距离为 $1$ 的平面（$Z_C = 1$），称为归一化聚焦平面。
将远处的三维点投影到此平面上。



1.3.4 齐次坐标与非齐次坐标
齐次坐标（Homogeneous Coordinates）：

定义：在原有坐标后增加一个维度（通常为 $1$），方便表示投影和变换。
表示：对于二维点 $m = (m_X, m_Y)^\top$，其齐次坐标为 $\bar{m} = (m_X, m_Y, 1)^\top$

作用：齐次坐标方便矩阵运算，尤其是在投影和变换过程中。"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "",
      "item": "http://localhost:1313/posts/signal_cn/3d%E9%87%8D%E5%BB%BA%E7%90%86%E8%AE%BA/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "",
  "name": "",
  "description": "1. 图像投影模型与3D重建理论 1.1. $SLAM$的概念 $SLAM$（Simultaneous Localization and Mapping，即同步定位与地图构建）。 通过估计每个相机的位置和场景的三维点，实现对场景的重建。 1.2. 逆向二维图像 从二维图像中提取三维场景的信息，即进行$3D$重建\n逆向投影\n图像是三维场景经过投影后的二维表示，要恢复三维信息，需要逆转这个投影过程。 建立一个数学模型，描述三维场景如何投影到二维图像中，然后尝试逆向求解。 1.3 针孔相机模型（Modèle Sténopé） 1.3.1 模型概述 定义：针孔相机模型假设所有的光线都通过一个公共点，即光心（光学中心）。 优点：模型简单，易于逆向计算，在三维重建中广泛使用。 1.3.2 坐标系和符号约定 摄像机坐标系： 原点 $O_C$：光学中心，坐标为 $(0, 0, 0)$。 轴方向：建立右手坐标系，$X_C$ 向右，$Y_C$ 向下，$Z_C$ 指向后方（场景深度方向）。 优势：$Z$ 轴指向后方，物体深度为正，符合直觉。 1.3.3 三维点的投影到归一化焦平面 三维点表示： 点 $U$：坐标为 $(U_X, U_Y, U_Z)$，表示空间中的一个三维点。 归一化焦平面： 一个与光心 $O_C$ 距离为 $1$ 的平面（$Z_C = 1$），称为归一化聚焦平面。 将远处的三维点投影到此平面上。 1.3.4 齐次坐标与非齐次坐标 齐次坐标（Homogeneous Coordinates）：\n定义：在原有坐标后增加一个维度（通常为 $1$），方便表示投影和变换。 表示：对于二维点 $m = (m_X, m_Y)^\\top$，其齐次坐标为 $\\bar{m} = (m_X, m_Y, 1)^\\top$ 作用：齐次坐标方便矩阵运算，尤其是在投影和变换过程中。\n",
  "keywords": [
    
  ],
  "articleBody": "1. 图像投影模型与3D重建理论 1.1. $SLAM$的概念 $SLAM$（Simultaneous Localization and Mapping，即同步定位与地图构建）。 通过估计每个相机的位置和场景的三维点，实现对场景的重建。 1.2. 逆向二维图像 从二维图像中提取三维场景的信息，即进行$3D$重建\n逆向投影\n图像是三维场景经过投影后的二维表示，要恢复三维信息，需要逆转这个投影过程。 建立一个数学模型，描述三维场景如何投影到二维图像中，然后尝试逆向求解。 1.3 针孔相机模型（Modèle Sténopé） 1.3.1 模型概述 定义：针孔相机模型假设所有的光线都通过一个公共点，即光心（光学中心）。 优点：模型简单，易于逆向计算，在三维重建中广泛使用。 1.3.2 坐标系和符号约定 摄像机坐标系： 原点 $O_C$：光学中心，坐标为 $(0, 0, 0)$。 轴方向：建立右手坐标系，$X_C$ 向右，$Y_C$ 向下，$Z_C$ 指向后方（场景深度方向）。 优势：$Z$ 轴指向后方，物体深度为正，符合直觉。 1.3.3 三维点的投影到归一化焦平面 三维点表示： 点 $U$：坐标为 $(U_X, U_Y, U_Z)$，表示空间中的一个三维点。 归一化焦平面： 一个与光心 $O_C$ 距离为 $1$ 的平面（$Z_C = 1$），称为归一化聚焦平面。 将远处的三维点投影到此平面上。 1.3.4 齐次坐标与非齐次坐标 齐次坐标（Homogeneous Coordinates）：\n定义：在原有坐标后增加一个维度（通常为 $1$），方便表示投影和变换。 表示：对于二维点 $m = (m_X, m_Y)^\\top$，其齐次坐标为 $\\bar{m} = (m_X, m_Y, 1)^\\top$ 作用：齐次坐标方便矩阵运算，尤其是在投影和变换过程中。\n非齐次坐标（Inhomogeneous Coordinates）： 标准的笛卡尔坐标表示法，不包含额外的维度。 1.4 摄像机的线性校准（Calibration） 1.4.1 从归一化焦平面到图像平面 图像平面：\n坐标系：像素坐标系，通常以图像左上角为原点，向右为 $X$ 轴（列索引），向下为 $Y$ 轴。 目的：将归一化焦平面上的点映射到实际的图像像素坐标上。 线性变换：\n变换公式：\n$$\\begin{cases} P_U = f \\cdot m_X + U_0 \\\\ P_V = f \\cdot m_Y + V_0 \\end{cases}$$ 焦距 $f$ $m_X$, $m_Y$ 是归一化焦平面上的点 光学中心在图像平面中的坐标 $(U_0, V_0)$\n1.4.2 摄像机内参矩阵（矩阵 $K$） 将上述线性变换表示为矩阵形式 $$K = \\begin{pmatrix} f \u0026 0 \u0026 U_0 \\\\ 0 \u0026 f \u0026 V_0 \\\\ 0 \u0026 0 \u0026 1 \\end{pmatrix}$$ 矩阵映射关系： $$\\underline{P} = K \\cdot \\underline{m}$$ 其中，$\\underline{P}$ 是图像平面中的点的齐次坐标\n1.4.3 逆向过程 从图像平面到归一化焦平面： $$\\underline{M} = K^{-1} \\cdot \\underline{P}$$ 1.4.4 可视锥（Cone of Visibility） 表示相机能够看到的空间范围。通过将图像的四个角点转换到归一化焦平面，然后连接光学中心，形成视锥。 1.5 畸变建模与校正 1.5.1 相机畸变的来源 实际相机镜头的光学缺陷，尤其在广角镜头中，导致图像出现畸变，直线变曲，图像边缘出现拉伸或压缩。 1.5.2 畸变模型 畸变函数：\n将归一化焦平面上的理想点经过畸变函数（从理想图像到畸变图像），得到畸变后的点，此点为 $2D$ 实际畸变聚焦平面\n$$\\underline{m}_d = d(\\underline{m}, k)$$ 其中，$k$ 是畸变参数\n举个例子: 多项式径向畸变模型\n$$M_d = \\left(1 + k_1 \\|m\\|_2^2 + k_2 \\|m\\|_2^4 + \\dots \\right) m$$ 其中: $|m|_2^2 = m_x^2 + m_y^2$\n1.6 TP1：畸变校正的实现 1.6.1 任务描述 目标：将畸变的实际图像校正为理想的无畸变图像 1.6.2 实现步骤 定义参数: 理想的摄像机内参矩阵 $K_{\\text{ideal}}$ ; 畸变的摄像机内参矩阵 $K_{\\text{real}}$; 失真参数 $k$ 。\n对于每个理想图像的像素坐标，执行以下步骤\n将像素坐标转换到归一化焦平面：\n$$\\underline{m}_{\\text{ideal}} = K_{\\text{ideal}}^{-1} \\cdot \\underline{P}_{\\text{ideal}}$$ 应用畸变函数：\n$$\\underline{m}_d = d(\\underline{m}_{\\text{ideal}}, k)$$ 映射回实际图像坐标系：\n$$\\underline{P}_{\\text{real}} = K_{\\text{real}} \\cdot \\underline{m}_d$$ 插值：\n对 $\\underline{P}_{\\text{real}}$ 进行插值（由于坐标可能为非整数，可能要用双线性插值）\n生成校正后的图像\n2. 二维刚性变换和单应性 2.1 二维刚性变换 二维刚性变换包括平移和旋转\n2.1.1 旋转： $$\\mathbf{U}^c = \\overrightarrow{O_c U}^c \\quad \\mathbf{U}^w = \\overrightarrow{O_w U}^w$$ $$\\mathbf{R}_{wc} \\underline{\\mathbf{U}}^c = \\mathbf{R}_{wc} \\cdot \\overrightarrow{O_c U}^c = \\overrightarrow{O_w U}^w$$ 从一个参考系中选取一个向量然后转换到另一个坐标系中\n$\\mathbf{R}_{wc}$ 是一个正交矩阵\n2.1.2 平移： $$\\mathbf{T}_{wc} = \\overrightarrow{O_w O_c}^{w}$$ 2.1.3 刚性变换公式： $$\\mathbf{U}^w = \\mathbf{R}_{wc} \\cdot \\mathbf{U}^c + \\mathbf{T}_{wc}$$ 证明：\n$$\\mathbf{R}_{wc} \\cdot \\mathbf{U}^c + \\mathbf{T}_{wc} = \\mathbf{R}_{wc} \\cdot \\overrightarrow{O_c U}^c + \\overrightarrow{O_w O_c}^w = \\overrightarrow{O_c U}^w + \\overrightarrow{O_w O_c}^w = \\overrightarrow{O_w U}^w = \\mathbf{U}^w$$ 2.1.4 齐次坐标： $$\\underline{\\mathbf{U}}^w = \\begin{bmatrix} \\mathbf{U}^w \\\\ 1 \\end{bmatrix}$$ $$\\mathbf{M}_{wc} = \\begin{bmatrix} \\mathbf{R}_{wc} \u0026 \\mathbf{T}_{wc} \\\\ 0 \u0026 1 \\end{bmatrix} = \\begin{bmatrix} r_{11} \u0026 r_{12} \u0026 r_{13} \u0026 t_{x} \\\\ r_{21} \u0026 r_{22} \u0026 r_{23} \u0026 t_{y} \\\\ r_{31} \u0026 r_{32} \u0026 r_{33} \u0026 t_{z} \\\\ 0 \u0026 0 \u0026 0 \u0026 1 \\end{bmatrix}$$ 2.1.5 反变换： $$\\mathbf{M}_{cw} = \\mathbf{M}_{wc}^{-1}$$ 2.1.6 变换的组合性： $$\\mathbf{M}_{ab} \\cdot \\mathbf{M}_{bc} = \\mathbf{M}_{ac}$$ 2.2 单应性 2.2.1 平面场景假设 $$\\mathbf{U}_i^A = z_i^A \\cdot \\underline{\\mathbf{m}}_{Ai}$$ 这个方程的意思就是，$\\mathbf{U}i^A$ 这个点可以由 $\\underline{\\mathbf{m}}{Ai}$ 来表示，怎么表示呢？$\\Rightarrow$ 乘它的深度即可（因为 $\\underline{\\mathbf{m}}_{Ai}$ 是单位深度）。\n2.2.2 寻找 $\\underline{\\mathbf{m}}{Ai}$ 和 $\\underline{\\mathbf{m}}{Bi}$ 之间的对应关系 光有这个方程，我们怎么找到 $\\underline{\\mathbf{m}}{Ai}$ 和 $\\underline{\\mathbf{m}}{Bi}$ 之间的对应关系呢，通俗来讲，怎么进行坐标对应变换呢？\n法线关键公式\n我们需要先回顾一个性质，来得到一个法线和平面间的关键公式\n在参考系 $A$ 中，平面 $P$ 的方程为：$ax + by + cz + d = 0$ 其中 $a, b, c$ 是平面法向量分量，$d$ 是常数项，代表平面 $P$ 和原点 $O_A$ 相对距离\n在向量形式中，平面方程可以化简为：\n$$\\mathbf{n}_A^\\top \\mathbf{U}_i^A + d = 0$$ $\\mathbf{n}_A^\\top$ 代表：向量 $P$ 在参考系 $A$ 中的法向量\n通过这个平面方程的向量形式，我们得到了一个带有法向量的一个很重要的公式。\n利用变量代换得到深度表达式\n将 $\\mathbf{U}i^A = z_i^A \\cdot \\underline{\\mathbf{m}}{A,i}$ 带入上式中\n$$\\mathbf{n}_A^\\top \\cdot z_i^A \\cdot \\underline{\\mathbf{m}}_{A,i} + d = 0 \\quad \\Rightarrow \\quad z_i^A = -\\dfrac{d}{\\mathbf{n}_A^\\top \\cdot \\underline{\\mathbf{m}}_{A,i}}$$ 这样，我们就把 $\\underline{\\mathbf{m}}_{Ai}$ 给引进来了，其中 $z_i^A = -\\dfrac{d}{\\mathbf{n}A^\\top \\cdot \\underline{\\mathbf{m}}{A,i}}$ 代表了深度。换句话说，我们利用 $\\mathbf{U}i^A$ 的两个方程，将 $\\mathbf{U}i^A$ 替换掉了，这样就得到 $z_i^A$ 深度，可是仍然解决不了问题 $\\Rightarrow$ 也就是说光有关于 $\\underline{\\mathbf{m}}{Ai}$ 的方程是不够的，还需要从 $\\underline{\\mathbf{m}}{Bi}$ 入手\n接下来我们找 $B$ 坐标系下的点 $\\underline{\\mathbf{m}}_{Bi}$\n我们从刚性变换公式入手 $\\mathbf{U}^w = \\mathbf{R}{wc} \\cdot \\mathbf{U}^c + \\mathbf{T}{wc}$ 可见从 $c$ 投影到 $w$ 只需要对 $\\mathbf{U}^c$ 进行变换即可，也就是说，为了得到 $\\underline{\\mathbf{m}}{Bi}$ 只需要对 $\\underline{\\mathbf{m}}{Ai}$ 进行刚性变换即可\n$$\\underline{\\mathbf{m}}_{B,i} = \\Pi \\left( \\mathbf{R}_{BA} \\mathbf{U}_i^A + \\mathbf{t}_{BA} \\right)$$ 其中 $\\Pi(\\cdot)$ 是投影函数\n$$\\underline{\\mathbf{m}}_{B,i}= \\Pi \\left( \\mathbf{R}_{BA} \\left( -\\dfrac{d}{\\mathbf{n}_A^\\top \\cdot \\underline{\\mathbf{m}}_{A,i}} \\right) \\cdot \\underline{\\mathbf{m}}_{A,i} + \\mathbf{t}_{BA} \\right)$$ 将上公式左右两边都乘 $-\\dfrac{\\mathbf{n}A^\\top \\cdot \\underline{\\mathbf{m}}{A,i}}{d}$\n$$\\underline{\\mathbf{m}}_{B,i}= \\Pi \\left( \\mathbf{R}_{BA} \\cdot \\underline{\\mathbf{m}}_{A,i} - \\dfrac{\\mathbf{n}_A^\\top \\cdot \\underline{\\mathbf{m}}_{A,i}}{d} \\cdot \\mathbf{t}_{BA} \\right)$$ $$\\underline{\\mathbf{m}}_{B,i} = \\Pi \\left( \\left( \\mathbf{R}_{BA} - \\dfrac{\\mathbf{t}_{BA} \\cdot \\mathbf{n}_A^\\top}{d} \\right) \\cdot \\underline{\\mathbf{m}}_{A,i} \\right)$$ 也就得到了各自归一化平面上 $A$ 点到 $B$ 点的对应关系\n问题：上述公式中左右两边都乘了 $-\\dfrac{\\mathbf{n}A^\\top \\cdot \\underline{\\mathbf{m}}{A,i}}{d}$，为什么保持不变？\n投影函数 $\\Pi(\\cdot)$ 的特点是它是一个比例不变的操作（即只看方向和相对位置，不看绝对尺度）。因此，即使我们在右边乘上 $-\\dfrac{\\mathbf{n}A^\\top \\cdot \\underline{\\mathbf{m}}{A,i}}{d}$，也不会影响等式成立的条件，因为投影结果相同\n2.2.3 寻找 $\\underline{\\mathbf{P}}{A,i}$ 和 $\\underline{\\mathbf{P}}{B,i}$ 之间的对应关系 我们已知：\n$\\left{ \\begin{aligned} \\underline{\\mathbf{m}}{A,i} = K_A^{-1} \\cdot \\underline{\\mathbf{P}}{A,i}\\ \\underline{\\mathbf{m}}{B,i} = K_B^{-1} \\cdot \\underline{\\mathbf{P}}{B,i} \\end{aligned} \\right.$\n$\\underline{\\mathbf{P}}{B,i} = K_B \\cdot \\underline{\\mathbf{m}}{B,i} \\Rightarrow$ 将上面得到的 $\\underline{\\mathbf{m}}_{B,i}$ 带入\n$$\\underline{\\mathbf{P}}_{B,i} = K_B \\cdot \\Pi \\left( \\left( \\mathbf{R}_{BA} - \\dfrac{\\mathbf{t}_{BA} \\cdot \\mathbf{n}_A^\\top}{d} \\right) \\cdot \\underline{\\mathbf{m}}_{A,i} \\right)$$ $$\\underline{\\mathbf{P}}_{B,i} = K_B \\cdot \\Pi \\left( \\left( \\mathbf{R}_{BA} - \\dfrac{\\mathbf{t}_{BA} \\cdot \\mathbf{n}_A^\\top}{d} \\right) \\cdot K_A^{-1} \\cdot \\underline{\\mathbf{P}}_{A,i} \\right)$$ 回顾性质：\n$$K \\cdot \\Pi \\left( \\begin{bmatrix} a \\\\ b \\\\ c \\end{bmatrix} \\right) = \\Pi \\left( K \\cdot \\begin{bmatrix} a \\\\ b \\\\ c \\end{bmatrix} \\right)$$ 利用此性质，可得：\n$$\\underline{\\mathbf{P}}_{B,i} = \\Pi \\left( K_B \\cdot \\left( \\mathbf{R}_{BA} - \\dfrac{\\mathbf{t}_{BA} \\cdot \\mathbf{n}_A^\\top}{d} \\right) \\cdot K_A^{-1} \\cdot \\underline{\\mathbf{P}}_{A,i}\\right)$$ 2.2.4 得到单应性矩阵 $\\mathbf{H}_{AB}$ 假设 $\\mathbf{H}{AB} = K_B \\cdot \\left( \\mathbf{R}{BA} - \\dfrac{\\mathbf{t}_{BA} \\cdot \\mathbf{n}_A^\\top}{d} \\right) \\cdot K_A^{-1}$\n因此：\n$\\left{ \\begin{aligned} \u0026\\underline{\\mathbf{P}}{B,i} = \\Pi \\left( \\mathbf{H}{BA} \\cdot \\underline{\\mathbf{P}}{A,i} \\right) \\quad \\quad A \\Rightarrow B\\ \u0026\\underline{\\mathbf{P}}{A,i} = \\Pi \\left( \\mathbf{H}{BA}^{-1} \\cdot \\underline{\\mathbf{P}}{B,i} \\right) = \\Pi \\left( \\mathbf{H}{AB} \\cdot \\underline{\\mathbf{P}}{B,i} \\right) \\quad \\quad B \\Rightarrow A \\ \\end{aligned} \\right.$\n通过单应性矩阵我们可以将某点从一个相机图片坐标系变换到另一个相机图片坐标系，也就是点映射关系\n2.2.5 单应性矩阵估计求解 $$\\mathbf{H}_{AB} = \\begin{bmatrix} h_1 \u0026 h_4 \u0026 h_7 \\\\ h_2 \u0026 h_5 \u0026 h_8 \\\\ h_3 \u0026 h_6 \u0026 h_9 \\end{bmatrix}$$ 这是一个齐次矩阵，它有 $9$ 个参数 $h_1$ 到 $h_9$，齐次矩阵在尺度上具有冗余性，所以会导致自由度的丢失\n简单的解法–参数化（要估计的参数 = 自由参数） $$\\mathbf{H}_{AB} = \\begin{bmatrix} h_1 \u0026 h_4 \u0026 h_7 \\\\ h_2 \u0026 h_5 \u0026 h_8 \\\\ h_3 \u0026 h_6 \u0026 1 \\end{bmatrix}$$ $$\\mathbf{h} = \\begin{bmatrix} h_1 \\\\ \\vdots \\\\ h_8 \\end{bmatrix}$$ 如何估计 $\\mathbf{h}$？\n在这种情况下只要我们了解一个对应点就可以求得 $h_1$ 到 $h_8$ $$\\underline{\\mathbf{P}}_{A,i} = \\Pi \\left( \\begin{bmatrix} h_1 \u0026 h_4 \u0026 h_7 \\\\ h_2 \u0026 h_5 \u0026 h_8 \\\\ h_3 \u0026 h_6 \u0026 1 \\end{bmatrix} \\cdot \\underline{\\mathbf{P}}_{B,i} \\right)$$ 由于 $\\underline{\\mathbf{P}}{A,i}$，$\\underline{\\mathbf{P}}{B,i}$ 是齐次坐标，我们将其展开：\n$$\\begin{bmatrix} P_{A,i,x} \\\\ P_{A,i,y} \\\\ 1 \\end{bmatrix} = \\Pi \\left( \\begin{bmatrix} h_1 \u0026 h_4 \u0026 h_7 \\\\ h_2 \u0026 h_5 \u0026 h_8 \\\\ h_3 \u0026 h_6 \u0026 1 \\end{bmatrix} \\cdot \\begin{bmatrix} P_{B,i,x} \\\\ P_{B,i,y} \\\\ 1 \\end{bmatrix} \\right)$$ $$\\left\\{ \\begin{aligned} P_{A,i,x} = \\dfrac{h_1 \\cdot P_{B,i,x} + h_4 \\cdot P_{B,i,y} + h_7}{h_3 \\cdot P_{B,i,x} + h_6 \\cdot P_{B,i,y} + 1} \\\\ P_{A,i,y} = \\dfrac{h_2 \\cdot P_{B,i,x} + h_5 \\cdot P_{B,i,y} + h_8}{h_3 \\cdot P_{B,i,x} + h_6 \\cdot P_{B,i,y} + 1} \\end{aligned} \\right.$$ $$\\left\\{ \\begin{aligned} P_{A,i,x} \\cdot \\left( h_3 \\cdot P_{B,i,x} + h_6 \\cdot P_{B,i,y} + 1 \\right) = h_1 \\cdot P_{B,i,x} + h_4 \\cdot P_{B,i,y} + h_7 \\\\ P_{A,i,y} \\cdot \\left( h_3 \\cdot P_{B,i,x} + h_6 \\cdot P_{B,i,y} + 1 \\right) = h_2 \\cdot P_{B,i,x} + h_5 \\cdot P_{B,i,y} + h_8 \\end{aligned} \\right.$$ $$\\begin{bmatrix} P_{B,i,x} \u0026 0 \u0026 -P_{A,i,x} \\cdot P_{B,i,x} \u0026 P_{B,i,y} \u0026 0 \u0026 -P_{A,i,x} \\cdot P_{B,i,y} \u0026 1 \u0026 0 \\\\ 0 \u0026 P_{B,i,x} \u0026 -P_{A,i,y} \\cdot P_{B,i,x} \u0026 0 \u0026 P_{B,i,y} \u0026 -P_{A,i,y} \\cdot P_{B,i,y} \u0026 0 \u0026 1 \\end{bmatrix} \\begin{bmatrix} h_1 \\\\ h_2 \\\\ h_3 \\\\ h_4 \\\\ h_5 \\\\ h_6 \\\\ h_7 \\\\ h_8 \\end{bmatrix} = \\begin{bmatrix} P_{A,i,x} \\\\ P_{A,i_y} \\end{bmatrix}$$ 因为有 $8$ 个未知数，需要八个独立的线性方程，而每对对应点可以提供两个对应方程（即方程 59），因此需要至少四对对应点。即需要四个匹配 $\\left( P_{A,i}, P_{B,i} \\right) \\quad i = 1, 2, 3, 4$。\n$\\Rightarrow \\mathbf{h}^* = \\arg\\min_{\\mathbf{h}} \\sum_{i=1}^{4} \\left\\lVert M_i \\mathbf{h} - P_{A,i} \\right\\rVert_2^2 \\Rightarrow$ 线性最小二乘法\n本文内容均为 ‘Vidéo 3D - Vision par ordinateur’ 课程下的理论部分，均为指导教师 Guillaume Bourmaud 的教学内容，所有版权归老师所有。\n具体实验内容及完整代码见 Guillaume Bourmaud 老师官方网站：https://gbourmaud.github.io/teaching/\n",
  "wordCount" : "1077",
  "inLanguage": "en",
  "image": "http://localhost:1313/images/papermod-cover.png","datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Zehua"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/signal_cn/3d%E9%87%8D%E5%BB%BA%E7%90%86%E8%AE%BA/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Home",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Home (Alt + H)">Home</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="http://localhost:1313/zh/" title="中文"
                            aria-label="中文">中文</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/posts/" title="List">
                    <span>List</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives" title="Timeline">
                    <span>Timeline</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="about">
                    <span>about</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="search (Alt &#43; /)" accesskey=/>
                    <span>search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      
    </h1>
    <div class="post-meta">Zehua

</div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#1-%e5%9b%be%e5%83%8f%e6%8a%95%e5%bd%b1%e6%a8%a1%e5%9e%8b%e4%b8%8e3d%e9%87%8d%e5%bb%ba%e7%90%86%e8%ae%ba" aria-label="1. 图像投影模型与3D重建理论"><strong>1. 图像投影模型与3D重建理论</strong></a><ul>
                            
                    <li>
                        <a href="#11-slam%e7%9a%84%e6%a6%82%e5%bf%b5" aria-label="1.1. $SLAM$的概念"><strong>1.1. $SLAM$的概念</strong></a></li>
                    <li>
                        <a href="#12-%e9%80%86%e5%90%91%e4%ba%8c%e7%bb%b4%e5%9b%be%e5%83%8f" aria-label="1.2. 逆向二维图像"><strong>1.2. 逆向二维图像</strong></a></li>
                    <li>
                        <a href="#13-%e9%92%88%e5%ad%94%e7%9b%b8%e6%9c%ba%e6%a8%a1%e5%9e%8bmod%c3%a8le-st%c3%a9nop%c3%a9" aria-label="1.3 针孔相机模型（Modèle Sténopé）"><strong>1.3 针孔相机模型（Modèle Sténopé）</strong></a><ul>
                            
                    <li>
                        <a href="#131-%e6%a8%a1%e5%9e%8b%e6%a6%82%e8%bf%b0" aria-label="1.3.1 模型概述"><strong>1.3.1 模型概述</strong></a></li>
                    <li>
                        <a href="#132-%e5%9d%90%e6%a0%87%e7%b3%bb%e5%92%8c%e7%ac%a6%e5%8f%b7%e7%ba%a6%e5%ae%9a" aria-label="1.3.2 坐标系和符号约定"><strong>1.3.2 坐标系和符号约定</strong></a></li>
                    <li>
                        <a href="#133-%e4%b8%89%e7%bb%b4%e7%82%b9%e7%9a%84%e6%8a%95%e5%bd%b1%e5%88%b0%e5%bd%92%e4%b8%80%e5%8c%96%e7%84%a6%e5%b9%b3%e9%9d%a2" aria-label="1.3.3 三维点的投影到归一化焦平面"><strong>1.3.3 三维点的投影到归一化焦平面</strong></a></li>
                    <li>
                        <a href="#134-%e9%bd%90%e6%ac%a1%e5%9d%90%e6%a0%87%e4%b8%8e%e9%9d%9e%e9%bd%90%e6%ac%a1%e5%9d%90%e6%a0%87" aria-label="1.3.4 齐次坐标与非齐次坐标"><strong>1.3.4 齐次坐标与非齐次坐标</strong></a></li></ul>
                    </li>
                    <li>
                        <a href="#14-%e6%91%84%e5%83%8f%e6%9c%ba%e7%9a%84%e7%ba%bf%e6%80%a7%e6%a0%a1%e5%87%86calibration" aria-label="1.4 摄像机的线性校准（Calibration）"><strong>1.4 摄像机的线性校准（Calibration）</strong></a><ul>
                            
                    <li>
                        <a href="#141-%e4%bb%8e%e5%bd%92%e4%b8%80%e5%8c%96%e7%84%a6%e5%b9%b3%e9%9d%a2%e5%88%b0%e5%9b%be%e5%83%8f%e5%b9%b3%e9%9d%a2" aria-label="1.4.1 从归一化焦平面到图像平面"><strong>1.4.1 从归一化焦平面到图像平面</strong></a></li>
                    <li>
                        <a href="#142-%e6%91%84%e5%83%8f%e6%9c%ba%e5%86%85%e5%8f%82%e7%9f%a9%e9%98%b5%e7%9f%a9%e9%98%b5-k" aria-label="1.4.2 摄像机内参矩阵（矩阵 $K$）"><strong>1.4.2 摄像机内参矩阵（矩阵 $K$）</strong></a></li>
                    <li>
                        <a href="#143-%e9%80%86%e5%90%91%e8%bf%87%e7%a8%8b" aria-label="1.4.3 逆向过程"><strong>1.4.3 逆向过程</strong></a></li>
                    <li>
                        <a href="#144-%e5%8f%af%e8%a7%86%e9%94%a5cone-of-visibility" aria-label="1.4.4 可视锥（Cone of Visibility）"><strong>1.4.4 可视锥（Cone of Visibility）</strong></a></li></ul>
                    </li>
                    <li>
                        <a href="#15-%e7%95%b8%e5%8f%98%e5%bb%ba%e6%a8%a1%e4%b8%8e%e6%a0%a1%e6%ad%a3" aria-label="1.5 畸变建模与校正"><strong>1.5 畸变建模与校正</strong></a><ul>
                            
                    <li>
                        <a href="#151-%e7%9b%b8%e6%9c%ba%e7%95%b8%e5%8f%98%e7%9a%84%e6%9d%a5%e6%ba%90" aria-label="1.5.1 相机畸变的来源"><strong>1.5.1 相机畸变的来源</strong></a></li>
                    <li>
                        <a href="#152-%e7%95%b8%e5%8f%98%e6%a8%a1%e5%9e%8b" aria-label="1.5.2 畸变模型"><strong>1.5.2 畸变模型</strong></a></li></ul>
                    </li>
                    <li>
                        <a href="#16-tp1%e7%95%b8%e5%8f%98%e6%a0%a1%e6%ad%a3%e7%9a%84%e5%ae%9e%e7%8e%b0" aria-label="1.6 TP1：畸变校正的实现"><strong>1.6 TP1：畸变校正的实现</strong></a><ul>
                            
                    <li>
                        <a href="#161-%e4%bb%bb%e5%8a%a1%e6%8f%8f%e8%bf%b0" aria-label="1.6.1 任务描述"><strong>1.6.1 任务描述</strong></a></li>
                    <li>
                        <a href="#162-%e5%ae%9e%e7%8e%b0%e6%ad%a5%e9%aa%a4" aria-label="1.6.2 实现步骤"><strong>1.6.2 实现步骤</strong></a></li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#2-%e4%ba%8c%e7%bb%b4%e5%88%9a%e6%80%a7%e5%8f%98%e6%8d%a2%e5%92%8c%e5%8d%95%e5%ba%94%e6%80%a7" aria-label="2. 二维刚性变换和单应性"><strong>2. 二维刚性变换和单应性</strong></a><ul>
                            
                    <li>
                        <a href="#21-%e4%ba%8c%e7%bb%b4%e5%88%9a%e6%80%a7%e5%8f%98%e6%8d%a2" aria-label="2.1 二维刚性变换"><strong>2.1 二维刚性变换</strong></a><ul>
                            
                    <li>
                        <a href="#211-%e6%97%8b%e8%bd%ac" aria-label="2.1.1 旋转："><strong>2.1.1 旋转：</strong></a></li>
                    <li>
                        <a href="#212-%e5%b9%b3%e7%a7%bb" aria-label="2.1.2 平移："><strong>2.1.2 平移：</strong></a></li>
                    <li>
                        <a href="#213-%e5%88%9a%e6%80%a7%e5%8f%98%e6%8d%a2%e5%85%ac%e5%bc%8f" aria-label="2.1.3 刚性变换公式："><strong>2.1.3 刚性变换公式：</strong></a></li>
                    <li>
                        <a href="#214-%e9%bd%90%e6%ac%a1%e5%9d%90%e6%a0%87" aria-label="2.1.4 齐次坐标："><strong>2.1.4 齐次坐标：</strong></a></li>
                    <li>
                        <a href="#215-%e5%8f%8d%e5%8f%98%e6%8d%a2" aria-label="2.1.5 反变换："><strong>2.1.5 反变换：</strong></a></li>
                    <li>
                        <a href="#216-%e5%8f%98%e6%8d%a2%e7%9a%84%e7%bb%84%e5%90%88%e6%80%a7" aria-label="2.1.6 变换的组合性："><strong>2.1.6 变换的组合性：</strong></a></li></ul>
                    </li>
                    <li>
                        <a href="#22-%e5%8d%95%e5%ba%94%e6%80%a7" aria-label="2.2 单应性"><strong>2.2 单应性</strong></a><ul>
                            
                    <li>
                        <a href="#221-%e5%b9%b3%e9%9d%a2%e5%9c%ba%e6%99%af%e5%81%87%e8%ae%be" aria-label="2.2.1 平面场景假设"><strong>2.2.1 平面场景假设</strong></a></li>
                    <li>
                        <a href="#222-%e5%af%bb%e6%89%be-underlinemathbfm_ai-%e5%92%8c-underlinemathbfm_bi-%e4%b9%8b%e9%97%b4%e7%9a%84%e5%af%b9%e5%ba%94%e5%85%b3%e7%b3%bb" aria-label="2.2.2 寻找 $\underline{\mathbf{m}}{Ai}$ 和 $\underline{\mathbf{m}}{Bi}$ 之间的对应关系"><strong>2.2.2 寻找 $\underline{\mathbf{m}}<em>{Ai}$ 和 $\underline{\mathbf{m}}</em>{Bi}$ 之间的对应关系</strong></a></li>
                    <li>
                        <a href="#223-%e5%af%bb%e6%89%be-underlinemathbfp_ai-%e5%92%8c-underlinemathbfp_bi-%e4%b9%8b%e9%97%b4%e7%9a%84%e5%af%b9%e5%ba%94%e5%85%b3%e7%b3%bb" aria-label="2.2.3 寻找 $\underline{\mathbf{P}}{A,i}$ 和 $\underline{\mathbf{P}}{B,i}$ 之间的对应关系"><strong>2.2.3 寻找 $\underline{\mathbf{P}}<em>{A,i}$ 和 $\underline{\mathbf{P}}</em>{B,i}$ 之间的对应关系</strong></a></li>
                    <li>
                        <a href="#224-%e5%be%97%e5%88%b0%e5%8d%95%e5%ba%94%e6%80%a7%e7%9f%a9%e9%98%b5-mathbfh_ab" aria-label="2.2.4 得到单应性矩阵 $\mathbf{H}_{AB}$"><strong>2.2.4 得到单应性矩阵 $\mathbf{H}_{AB}$</strong></a></li>
                    <li>
                        <a href="#225-%e5%8d%95%e5%ba%94%e6%80%a7%e7%9f%a9%e9%98%b5%e4%bc%b0%e8%ae%a1%e6%b1%82%e8%a7%a3" aria-label="2.2.5 单应性矩阵估计求解"><strong>2.2.5 单应性矩阵估计求解</strong></a>
                    </li>
                </ul>
                </li>
                </ul>
                </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>

  <div class="post-content"><h1 id="1-图像投影模型与3d重建理论"><strong>1. 图像投影模型与3D重建理论</strong><a hidden class="anchor" aria-hidden="true" href="#1-图像投影模型与3d重建理论">#</a></h1>
<h2 id="11-slam的概念"><strong>1.1. $SLAM$的概念</strong><a hidden class="anchor" aria-hidden="true" href="#11-slam的概念">#</a></h2>
<ul>
<li>$SLAM$（Simultaneous Localization and Mapping，即同步定位与地图构建）。</li>
<li>通过估计每个相机的位置和场景的三维点，实现对场景的重建。</li>
</ul>
<h2 id="12-逆向二维图像"><strong>1.2. 逆向二维图像</strong><a hidden class="anchor" aria-hidden="true" href="#12-逆向二维图像">#</a></h2>
<p>从二维图像中提取三维场景的信息，即进行$3D$重建</p>
<p><strong>逆向投影</strong></p>
<ul>
<li>图像是三维场景经过投影后的二维表示，要恢复三维信息，需要逆转这个投影过程。</li>
<li>建立一个数学模型，描述三维场景如何投影到二维图像中，然后尝试逆向求解。</li>
</ul>
<h2 id="13-针孔相机模型modèle-sténopé"><strong>1.3 针孔相机模型（Modèle Sténopé）</strong><a hidden class="anchor" aria-hidden="true" href="#13-针孔相机模型modèle-sténopé">#</a></h2>
<h3 id="131-模型概述"><strong>1.3.1 模型概述</strong><a hidden class="anchor" aria-hidden="true" href="#131-模型概述">#</a></h3>
<ul>
<li><strong>定义</strong>：针孔相机模型假设所有的光线都通过一个公共点，即光心（光学中心）。</li>
<li><strong>优点</strong>：模型简单，易于逆向计算，在三维重建中广泛使用。</li>
</ul>
<h3 id="132-坐标系和符号约定"><strong>1.3.2 坐标系和符号约定</strong><a hidden class="anchor" aria-hidden="true" href="#132-坐标系和符号约定">#</a></h3>
<ul>
<li><strong>摄像机坐标系</strong>：
<ul>
<li><strong>原点 $O_C$</strong>：光学中心，坐标为 $(0, 0, 0)$。</li>
<li><strong>轴方向</strong>：建立右手坐标系，$X_C$ 向右，$Y_C$ 向下，$Z_C$ 指向后方（场景深度方向）。</li>
<li><strong>优势</strong>：$Z$ 轴指向后方，物体深度为正，符合直觉。</li>
</ul>
</li>
</ul>
<h3 id="133-三维点的投影到归一化焦平面"><strong>1.3.3 三维点的投影到归一化焦平面</strong><a hidden class="anchor" aria-hidden="true" href="#133-三维点的投影到归一化焦平面">#</a></h3>
<ul>
<li><strong>三维点表示</strong>：
<ul>
<li><strong>点 $U$</strong>：坐标为 $(U_X, U_Y, U_Z)$，表示空间中的一个三维点。</li>
</ul>
</li>
<li><strong>归一化焦平面</strong>：
<ul>
<li>一个与光心 $O_C$ 距离为 $1$ 的平面（$Z_C = 1$），称为归一化聚焦平面。</li>
<li>将远处的三维点投影到此平面上。</li>
</ul>
</li>
</ul>
<h3 id="134-齐次坐标与非齐次坐标"><strong>1.3.4 齐次坐标与非齐次坐标</strong><a hidden class="anchor" aria-hidden="true" href="#134-齐次坐标与非齐次坐标">#</a></h3>
<p><strong>齐次坐标（Homogeneous Coordinates）</strong>：</p>
<ul>
<li><strong>定义</strong>：在原有坐标后增加一个维度（通常为 $1$），方便表示投影和变换。</li>
<li><strong>表示</strong>：对于二维点 $m = (m_X, m_Y)^\top$，其齐次坐标为 $\bar{m} = (m_X, m_Y, 1)^\top$</li>
</ul>
<p><strong>作用</strong>：齐次坐标方便矩阵运算，尤其是在投影和变换过程中。</p>
<ul>
<li><strong>非齐次坐标（Inhomogeneous Coordinates）</strong>：
<ul>
<li>标准的笛卡尔坐标表示法，不包含额外的维度。</li>
</ul>
</li>
</ul>
<h2 id="14-摄像机的线性校准calibration"><strong>1.4 摄像机的线性校准（Calibration）</strong><a hidden class="anchor" aria-hidden="true" href="#14-摄像机的线性校准calibration">#</a></h2>
<h3 id="141-从归一化焦平面到图像平面"><strong>1.4.1 从归一化焦平面到图像平面</strong><a hidden class="anchor" aria-hidden="true" href="#141-从归一化焦平面到图像平面">#</a></h3>
<ul>
<li>
<p><strong>图像平面</strong>：</p>
<ul>
<li><strong>坐标系</strong>：像素坐标系，通常以图像左上角为原点，向右为 $X$ 轴（列索引），向下为 $Y$ 轴。</li>
<li><strong>目的</strong>：将归一化焦平面上的点映射到实际的图像像素坐标上。</li>
</ul>
</li>
<li>
<p><strong>线性变换</strong>：</p>
</li>
<li>
<p><strong>变换公式</strong>：</p>
<div>$$\begin{cases} P_U = f \cdot m_X + U_0 \\ P_V = f \cdot m_Y + V_0 \end{cases}$$</div>
<ul>
<li><strong>焦距 $f$</strong></li>
<li>$m_X$, $m_Y$ <strong>是归一化焦平面上的点</strong></li>
</ul>
</li>
<li>
<p><strong>光学中心在图像平面中的坐标</strong> $(U_0, V_0)$</p>
</li>
</ul>
<h3 id="142-摄像机内参矩阵矩阵-k"><strong>1.4.2 摄像机内参矩阵（矩阵 $K$）</strong><a hidden class="anchor" aria-hidden="true" href="#142-摄像机内参矩阵矩阵-k">#</a></h3>
<ul>
<li>将上述线性变换表示为矩阵形式</li>
</ul>
<div>$$K = \begin{pmatrix} f & 0 & U_0 \\ 0 & f & V_0 \\ 0 & 0 & 1 \end{pmatrix}$$</div>
<ul>
<li><strong>矩阵映射关系</strong>：</li>
</ul>
<div>$$\underline{P} = K \cdot \underline{m}$$</div>
<p>其中，$\underline{P}$ 是图像平面中的点的齐次坐标</p>
<h3 id="143-逆向过程"><strong>1.4.3 逆向过程</strong><a hidden class="anchor" aria-hidden="true" href="#143-逆向过程">#</a></h3>
<ul>
<li><strong>从图像平面到归一化焦平面</strong>：</li>
</ul>
<div>$$\underline{M} = K^{-1} \cdot \underline{P}$$</div>
<h3 id="144-可视锥cone-of-visibility"><strong>1.4.4 可视锥（Cone of Visibility）</strong><a hidden class="anchor" aria-hidden="true" href="#144-可视锥cone-of-visibility">#</a></h3>
<ul>
<li>表示相机能够看到的空间范围。通过将图像的四个角点转换到归一化焦平面，然后连接光学中心，形成视锥。</li>
</ul>
<h2 id="15-畸变建模与校正"><strong>1.5 畸变建模与校正</strong><a hidden class="anchor" aria-hidden="true" href="#15-畸变建模与校正">#</a></h2>
<h3 id="151-相机畸变的来源"><strong>1.5.1 相机畸变的来源</strong><a hidden class="anchor" aria-hidden="true" href="#151-相机畸变的来源">#</a></h3>
<ul>
<li>实际相机镜头的光学缺陷，尤其在广角镜头中，导致图像出现畸变，直线变曲，图像边缘出现拉伸或压缩。</li>
</ul>
<h3 id="152-畸变模型"><strong>1.5.2 畸变模型</strong><a hidden class="anchor" aria-hidden="true" href="#152-畸变模型">#</a></h3>
<ul>
<li>
<p><strong>畸变函数</strong>：</p>
<ul>
<li>
<p>将归一化焦平面上的理想点经过畸变函数（从理想图像到畸变图像），得到畸变后的点，此点为 $2D$ 实际畸变聚焦平面</p>
<div>$$\underline{m}_d = d(\underline{m}, k)$$</div>
<p>其中，$k$ 是畸变参数</p>
</li>
</ul>
</li>
<li>
<p><strong>举个例子: 多项式径向畸变模型</strong></p>
<div>$$M_d = \left(1 + k_1 \|m\|_2^2 + k_2 \|m\|_2^4 + \dots \right) m$$</div>
<p>其中: $|m|_2^2 = m_x^2 + m_y^2$</p>
</li>
</ul>
<h2 id="16-tp1畸变校正的实现"><strong>1.6 TP1：畸变校正的实现</strong><a hidden class="anchor" aria-hidden="true" href="#16-tp1畸变校正的实现">#</a></h2>
<h3 id="161-任务描述"><strong>1.6.1 任务描述</strong><a hidden class="anchor" aria-hidden="true" href="#161-任务描述">#</a></h3>
<ul>
<li><strong>目标</strong>：将畸变的实际图像校正为理想的无畸变图像</li>
</ul>
<h3 id="162-实现步骤"><strong>1.6.2 实现步骤</strong><a hidden class="anchor" aria-hidden="true" href="#162-实现步骤">#</a></h3>
<p><strong>定义参数</strong>: 理想的摄像机内参矩阵 $K_{\text{ideal}}$ ; 畸变的摄像机内参矩阵 $K_{\text{real}}$; 失真参数 $k$ 。</p>
<p><strong>对于每个理想图像的像素坐标，执行以下步骤</strong></p>
<ol>
<li>
<p><strong>将像素坐标转换到归一化焦平面</strong>：</p>
<div>$$\underline{m}_{\text{ideal}} = K_{\text{ideal}}^{-1} \cdot \underline{P}_{\text{ideal}}$$</div>
</li>
<li>
<p><strong>应用畸变函数</strong>：</p>
<div>$$\underline{m}_d = d(\underline{m}_{\text{ideal}}, k)$$</div>
</li>
<li>
<p><strong>映射回实际图像坐标系</strong>：</p>
<div>$$\underline{P}_{\text{real}} = K_{\text{real}} \cdot \underline{m}_d$$</div>
</li>
<li>
<p><strong>插值</strong>：</p>
<p>对 $\underline{P}_{\text{real}}$ 进行插值（由于坐标可能为非整数，可能要用双线性插值）</p>
</li>
<li>
<p><strong>生成校正后的图像</strong></p>
</li>
</ol>
<h1 id="2-二维刚性变换和单应性"><strong>2. 二维刚性变换和单应性</strong><a hidden class="anchor" aria-hidden="true" href="#2-二维刚性变换和单应性">#</a></h1>
<h2 id="21-二维刚性变换"><strong>2.1 二维刚性变换</strong><a hidden class="anchor" aria-hidden="true" href="#21-二维刚性变换">#</a></h2>
<p>二维刚性变换包括<strong>平移</strong>和<strong>旋转</strong></p>
<h3 id="211-旋转"><strong>2.1.1 旋转：</strong><a hidden class="anchor" aria-hidden="true" href="#211-旋转">#</a></h3>
<div>$$\mathbf{U}^c = \overrightarrow{O_c U}^c \quad \mathbf{U}^w = \overrightarrow{O_w U}^w$$</div>
<div>$$\mathbf{R}_{wc} \underline{\mathbf{U}}^c = \mathbf{R}_{wc} \cdot \overrightarrow{O_c U}^c = \overrightarrow{O_w U}^w$$</div>
<p>从一个参考系中选取一个向量然后转换到另一个坐标系中</p>
<p>$\mathbf{R}_{wc}$ 是一个正交矩阵</p>
<h3 id="212-平移"><strong>2.1.2 平移：</strong><a hidden class="anchor" aria-hidden="true" href="#212-平移">#</a></h3>
<div>$$\mathbf{T}_{wc} = \overrightarrow{O_w O_c}^{w}$$</div>
<h3 id="213-刚性变换公式"><strong>2.1.3 刚性变换公式：</strong><a hidden class="anchor" aria-hidden="true" href="#213-刚性变换公式">#</a></h3>
<div>$$\mathbf{U}^w = \mathbf{R}_{wc} \cdot \mathbf{U}^c + \mathbf{T}_{wc}$$</div>
<p><strong>证明：</strong></p>
<div>$$\mathbf{R}_{wc} \cdot \mathbf{U}^c + \mathbf{T}_{wc} = \mathbf{R}_{wc} \cdot \overrightarrow{O_c U}^c + \overrightarrow{O_w O_c}^w = \overrightarrow{O_c U}^w + \overrightarrow{O_w O_c}^w = \overrightarrow{O_w U}^w = \mathbf{U}^w$$</div>
<h3 id="214-齐次坐标"><strong>2.1.4 齐次坐标：</strong><a hidden class="anchor" aria-hidden="true" href="#214-齐次坐标">#</a></h3>
<div>$$\underline{\mathbf{U}}^w = \begin{bmatrix} \mathbf{U}^w \\ 1 \end{bmatrix}$$</div>
<div>$$\mathbf{M}_{wc} = \begin{bmatrix} \mathbf{R}_{wc} & \mathbf{T}_{wc} \\ 0 & 1 \end{bmatrix} = \begin{bmatrix} r_{11} & r_{12} & r_{13} & t_{x} \\ r_{21} & r_{22} & r_{23} & t_{y} \\ r_{31} & r_{32} & r_{33} & t_{z} \\ 0 & 0 & 0 & 1 \end{bmatrix}$$</div>
<h3 id="215-反变换"><strong>2.1.5 反变换：</strong><a hidden class="anchor" aria-hidden="true" href="#215-反变换">#</a></h3>
<div>$$\mathbf{M}_{cw} = \mathbf{M}_{wc}^{-1}$$</div>
<h3 id="216-变换的组合性"><strong>2.1.6 变换的组合性：</strong><a hidden class="anchor" aria-hidden="true" href="#216-变换的组合性">#</a></h3>
<div>$$\mathbf{M}_{ab} \cdot \mathbf{M}_{bc} = \mathbf{M}_{ac}$$</div>
<h2 id="22-单应性"><strong>2.2 单应性</strong><a hidden class="anchor" aria-hidden="true" href="#22-单应性">#</a></h2>
<h3 id="221-平面场景假设"><strong>2.2.1 平面场景假设</strong><a hidden class="anchor" aria-hidden="true" href="#221-平面场景假设">#</a></h3>
<div>$$\mathbf{U}_i^A = z_i^A \cdot \underline{\mathbf{m}}_{Ai}$$</div>
<p>这个方程的意思就是，$\mathbf{U}<em>i^A$ 这个点可以由 $\underline{\mathbf{m}}</em>{Ai}$ 来表示，怎么表示呢？$\Rightarrow$ 乘它的深度即可（因为 $\underline{\mathbf{m}}_{Ai}$ 是单位深度）。</p>
<h3 id="222-寻找-underlinemathbfm_ai-和-underlinemathbfm_bi-之间的对应关系"><strong>2.2.2 寻找 $\underline{\mathbf{m}}<em>{Ai}$ 和 $\underline{\mathbf{m}}</em>{Bi}$ 之间的对应关系</strong><a hidden class="anchor" aria-hidden="true" href="#222-寻找-underlinemathbfm_ai-和-underlinemathbfm_bi-之间的对应关系">#</a></h3>
<p>光有这个方程，我们怎么找到 $\underline{\mathbf{m}}<em>{Ai}$ 和 $\underline{\mathbf{m}}</em>{Bi}$ 之间的对应关系呢，通俗来讲，怎么进行坐标对应变换呢？</p>
<ol>
<li>
<p><strong>法线关键公式</strong></p>
<p>我们需要先回顾一个性质，来得到一个法线和平面间的关键公式</p>
<p>在参考系 $A$ 中，平面 $P$ 的方程为：$ax + by + cz + d = 0$ 其中 $a, b, c$ 是平面法向量分量，$d$ 是常数项，代表平面 $P$ 和原点 $O_A$ 相对距离</p>
<p>在向量形式中，平面方程可以化简为：</p>
<div>$$\mathbf{n}_A^\top \mathbf{U}_i^A + d = 0$$</div>
<p>$\mathbf{n}_A^\top$ 代表：向量 $P$ 在参考系 $A$ 中的法向量</p>
<p>通过这个平面方程的向量形式，我们得到了一个带有法向量的一个很重要的公式。</p>
</li>
<li>
<p><strong>利用变量代换得到深度表达式</strong></p>
<p>将 $\mathbf{U}<em>i^A = z_i^A \cdot \underline{\mathbf{m}}</em>{A,i}$ 带入上式中</p>
<div>$$\mathbf{n}_A^\top \cdot z_i^A \cdot \underline{\mathbf{m}}_{A,i} + d = 0 \quad \Rightarrow \quad z_i^A = -\dfrac{d}{\mathbf{n}_A^\top \cdot \underline{\mathbf{m}}_{A,i}}$$</div>
<p>这样，我们就把 $\underline{\mathbf{m}}_{Ai}$ 给引进来了，其中 $z_i^A = -\dfrac{d}{\mathbf{n}<em>A^\top \cdot \underline{\mathbf{m}}</em>{A,i}}$ 代表了深度。换句话说，我们利用 $\mathbf{U}<em>i^A$ 的两个方程，将 $\mathbf{U}<em>i^A$ 替换掉了，这样就得到 $z_i^A$ 深度，可是仍然解决不了问题 $\Rightarrow$ 也就是说光有关于 $\underline{\mathbf{m}}</em>{Ai}$ 的方程是不够的，还需要从 $\underline{\mathbf{m}}</em>{Bi}$ 入手</p>
</li>
<li>
<p><strong>接下来我们找 $B$ 坐标系下的点 $\underline{\mathbf{m}}_{Bi}$</strong></p>
<p>我们从刚性变换公式入手 $\mathbf{U}^w = \mathbf{R}<em>{wc} \cdot \mathbf{U}^c + \mathbf{T}</em>{wc}$ 可见从 $c$ 投影到 $w$ 只需要对 $\mathbf{U}^c$ 进行变换即可，也就是说，为了得到 $\underline{\mathbf{m}}<em>{Bi}$ 只需要对 $\underline{\mathbf{m}}</em>{Ai}$ 进行刚性变换即可</p>
<div>$$\underline{\mathbf{m}}_{B,i} = \Pi \left( \mathbf{R}_{BA} \mathbf{U}_i^A + \mathbf{t}_{BA} \right)$$</div>
<p>其中 $\Pi(\cdot)$ 是投影函数</p>
<div>$$\underline{\mathbf{m}}_{B,i}= \Pi \left( \mathbf{R}_{BA} \left( -\dfrac{d}{\mathbf{n}_A^\top \cdot \underline{\mathbf{m}}_{A,i}} \right) \cdot \underline{\mathbf{m}}_{A,i} + \mathbf{t}_{BA} \right)$$</div>
<p>将上公式左右两边都乘 $-\dfrac{\mathbf{n}<em>A^\top \cdot \underline{\mathbf{m}}</em>{A,i}}{d}$</p>
<div>$$\underline{\mathbf{m}}_{B,i}= \Pi \left( \mathbf{R}_{BA} \cdot \underline{\mathbf{m}}_{A,i} - \dfrac{\mathbf{n}_A^\top \cdot \underline{\mathbf{m}}_{A,i}}{d} \cdot \mathbf{t}_{BA} \right)$$</div>
<div>$$\underline{\mathbf{m}}_{B,i} = \Pi \left( \left( \mathbf{R}_{BA} - \dfrac{\mathbf{t}_{BA} \cdot \mathbf{n}_A^\top}{d} \right) \cdot \underline{\mathbf{m}}_{A,i} \right)$$</div>
<p>也就得到了各自归一化平面上 $A$ 点到 $B$ 点的对应关系</p>
<p><strong>问题：上述公式中左右两边都乘了 $-\dfrac{\mathbf{n}<em>A^\top \cdot \underline{\mathbf{m}}</em>{A,i}}{d}$，为什么保持不变？</strong></p>
<p>投影函数 $\Pi(\cdot)$ 的特点是它是一个比例不变的操作（即只看方向和相对位置，不看绝对尺度）。因此，即使我们在右边乘上 $-\dfrac{\mathbf{n}<em>A^\top \cdot \underline{\mathbf{m}}</em>{A,i}}{d}$，也不会影响等式成立的条件，因为投影结果相同</p>
</li>
</ol>
<h3 id="223-寻找-underlinemathbfp_ai-和-underlinemathbfp_bi-之间的对应关系"><strong>2.2.3 寻找 $\underline{\mathbf{P}}<em>{A,i}$ 和 $\underline{\mathbf{P}}</em>{B,i}$ 之间的对应关系</strong><a hidden class="anchor" aria-hidden="true" href="#223-寻找-underlinemathbfp_ai-和-underlinemathbfp_bi-之间的对应关系">#</a></h3>
<p>我们已知：</p>
<p>$\left{ \begin{aligned} \underline{\mathbf{m}}<em>{A,i} = K_A^{-1} \cdot \underline{\mathbf{P}}</em>{A,i}\ \underline{\mathbf{m}}<em>{B,i} = K_B^{-1} \cdot \underline{\mathbf{P}}</em>{B,i} \end{aligned} \right.$</p>
<p>$\underline{\mathbf{P}}<em>{B,i} = K_B \cdot \underline{\mathbf{m}}</em>{B,i} \Rightarrow$ 将上面得到的 $\underline{\mathbf{m}}_{B,i}$ 带入</p>
<div>$$\underline{\mathbf{P}}_{B,i} = K_B \cdot \Pi \left( \left( \mathbf{R}_{BA} - \dfrac{\mathbf{t}_{BA} \cdot \mathbf{n}_A^\top}{d} \right) \cdot \underline{\mathbf{m}}_{A,i} \right)$$</div>
<div>$$\underline{\mathbf{P}}_{B,i} = K_B \cdot \Pi \left( \left( \mathbf{R}_{BA} - \dfrac{\mathbf{t}_{BA} \cdot \mathbf{n}_A^\top}{d} \right) \cdot K_A^{-1} \cdot \underline{\mathbf{P}}_{A,i} \right)$$</div>
<p>回顾性质：</p>
<div>$$K \cdot \Pi \left( \begin{bmatrix} a \\ b \\ c \end{bmatrix} \right) = \Pi \left( K \cdot \begin{bmatrix} a \\ b \\ c \end{bmatrix} \right)$$</div>
<p>利用此性质，可得：</p>
<div>$$\underline{\mathbf{P}}_{B,i} = \Pi \left( K_B \cdot \left( \mathbf{R}_{BA} - \dfrac{\mathbf{t}_{BA} \cdot \mathbf{n}_A^\top}{d} \right) \cdot K_A^{-1} \cdot \underline{\mathbf{P}}_{A,i}\right)$$</div>
<h3 id="224-得到单应性矩阵-mathbfh_ab"><strong>2.2.4 得到单应性矩阵 $\mathbf{H}_{AB}$</strong><a hidden class="anchor" aria-hidden="true" href="#224-得到单应性矩阵-mathbfh_ab">#</a></h3>
<p>假设 $\mathbf{H}<em>{AB} = K_B \cdot \left( \mathbf{R}</em>{BA} - \dfrac{\mathbf{t}_{BA} \cdot \mathbf{n}_A^\top}{d} \right) \cdot K_A^{-1}$</p>
<p>因此：</p>
<p>$\left{ \begin{aligned} &amp;\underline{\mathbf{P}}<em>{B,i} = \Pi \left( \mathbf{H}</em>{BA} \cdot \underline{\mathbf{P}}<em>{A,i} \right) \quad \quad  A \Rightarrow B\ &amp;\underline{\mathbf{P}}</em>{A,i} = \Pi \left( \mathbf{H}<em>{BA}^{-1} \cdot \underline{\mathbf{P}}</em>{B,i} \right) = \Pi \left( \mathbf{H}<em>{AB} \cdot \underline{\mathbf{P}}</em>{B,i} \right) \quad \quad  B \Rightarrow A \ \end{aligned} \right.$</p>
<p>通过单应性矩阵我们可以将某点从一个相机图片坐标系变换到另一个相机图片坐标系，也就是点映射关系</p>
<h3 id="225-单应性矩阵估计求解"><strong>2.2.5 单应性矩阵估计求解</strong><a hidden class="anchor" aria-hidden="true" href="#225-单应性矩阵估计求解">#</a></h3>
<div>$$\mathbf{H}_{AB} = \begin{bmatrix} h_1 & h_4 & h_7 \\ h_2 & h_5 & h_8 \\ h_3 & h_6 & h_9 \end{bmatrix}$$</div>
<p>这是一个齐次矩阵，它有 $9$ 个参数 $h_1$ 到 $h_9$，齐次矩阵在尺度上具有冗余性，所以会导致自由度的丢失</p>
<ul>
<li>简单的解法&ndash;参数化（要估计的参数 = 自由参数）</li>
</ul>
<div>$$\mathbf{H}_{AB} = \begin{bmatrix} h_1 & h_4 & h_7 \\ h_2 & h_5 & h_8 \\ h_3 & h_6 & 1 \end{bmatrix}$$</div>
<div>$$\mathbf{h} = \begin{bmatrix} h_1 \\ \vdots \\ h_8 \end{bmatrix}$$</div>
<p>如何估计 $\mathbf{h}$？</p>
<ul>
<li>在这种情况下只要我们了解一个对应点就可以求得 $h_1$ 到 $h_8$</li>
</ul>
<div>$$\underline{\mathbf{P}}_{A,i} = \Pi \left( \begin{bmatrix} h_1 & h_4 & h_7 \\ h_2 & h_5 & h_8 \\ h_3 & h_6 & 1 \end{bmatrix} \cdot \underline{\mathbf{P}}_{B,i} \right)$$</div>
<p>由于 $\underline{\mathbf{P}}<em>{A,i}$，$\underline{\mathbf{P}}</em>{B,i}$ 是齐次坐标，我们将其展开：</p>
<div>$$\begin{bmatrix} P_{A,i,x} \\ P_{A,i,y} \\ 1 \end{bmatrix} = \Pi \left( \begin{bmatrix} h_1 & h_4 & h_7 \\ h_2 & h_5 & h_8 \\ h_3 & h_6 & 1 \end{bmatrix} \cdot \begin{bmatrix} P_{B,i,x} \\ P_{B,i,y} \\ 1 \end{bmatrix} \right)$$</div>
<div>$$\left\{ \begin{aligned} P_{A,i,x} = \dfrac{h_1 \cdot P_{B,i,x} + h_4 \cdot P_{B,i,y} + h_7}{h_3 \cdot P_{B,i,x} + h_6 \cdot P_{B,i,y} + 1} \\ P_{A,i,y} = \dfrac{h_2 \cdot P_{B,i,x} + h_5 \cdot P_{B,i,y} + h_8}{h_3 \cdot P_{B,i,x} + h_6 \cdot P_{B,i,y} + 1} \end{aligned} \right.$$</div>
<div>$$\left\{ \begin{aligned} P_{A,i,x} \cdot \left( h_3 \cdot P_{B,i,x} + h_6 \cdot P_{B,i,y} + 1 \right) = h_1 \cdot P_{B,i,x} + h_4 \cdot P_{B,i,y} + h_7 \\ P_{A,i,y} \cdot \left( h_3 \cdot P_{B,i,x} + h_6 \cdot P_{B,i,y} + 1 \right) = h_2 \cdot P_{B,i,x} + h_5 \cdot P_{B,i,y} + h_8 \end{aligned} \right.$$</div>
<div>$$\begin{bmatrix} P_{B,i,x} & 0 & -P_{A,i,x} \cdot P_{B,i,x} & P_{B,i,y} & 0 & -P_{A,i,x} \cdot P_{B,i,y} & 1 & 0 \\ 0 & P_{B,i,x} & -P_{A,i,y} \cdot P_{B,i,x} & 0 & P_{B,i,y} & -P_{A,i,y} \cdot P_{B,i,y} & 0 & 1 \end{bmatrix} \begin{bmatrix} h_1 \\ h_2 \\ h_3 \\ h_4 \\ h_5 \\ h_6 \\ h_7 \\ h_8 \end{bmatrix} = \begin{bmatrix} P_{A,i,x} \\ P_{A,i_y} \end{bmatrix}$$</div>
<p>因为有 $8$ 个未知数，需要八个独立的线性方程，而每对对应点可以提供两个对应方程（即方程 59），因此需要至少四对对应点。即需要四个匹配 $\left( P_{A,i}, P_{B,i} \right) \quad i = 1, 2, 3, 4$。</p>
<p>$\Rightarrow \mathbf{h}^* = \arg\min_{\mathbf{h}} \sum_{i=1}^{4} \left\lVert M_i \mathbf{h} - P_{A,i} \right\rVert_2^2 \Rightarrow$ 线性最小二乘法</p>
<hr>
<blockquote>
<p>本文内容均为 &lsquo;Vidéo 3D - <strong>Vision par ordinateur</strong>&rsquo; 课程下的理论部分，均为指导教师 <strong>Guillaume Bourmaud</strong> 的教学内容，所有版权归老师所有。</p>
<p>具体实验内容及完整代码见 <strong>Guillaume Bourmaud</strong> 老师官方网站：https://gbourmaud.github.io/teaching/</p>
</blockquote>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/my-first-post/">
    <span class="title">« Prev</span>
    <br>
    <span>My First Post</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span><a href="https://github.com/adityatelange/hugo-PaperMod/graphs/contributors">PaperMod</a></span> · 


    <span>
        
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a>  
        
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
