---
title: "卡尔曼滤波"
# author: "Zehua"
date: "2024-11-05T16:25:17+01:00"
lastmod: "2024-11-06T17:12:35+08:00"
lang: "zh"
draft: false
summary: "实验内容"
description: "图像恢复中去卷积问题"
tags: ["信号处理","图像处理"]
# categories: "posts"
#cover:
    #image: "img/signal.png"
# comments: true
# hideMeta: false
searchHidden: true
# ShowBreadCrumbs: true
# ShowReadingTime: false

---







Ex 1

设 $x$ 是一个包含 1000 个点的随机变量，均值为 2，$e$ 是一个包含 1000 个点的高斯白噪声。定义：
$$
y = 2x^2 + e
$$
绘制 $y$ 关于 $x$ 的图像，以及 $\tilde{y}$ 关于 $\tilde{x}$ 的图像。计算 $x$ 和 $y$ 的均值及协方差矩阵。

解
$$
\tilde{y} = y - \bar{y}
$$
均值：
$$
\mathbb{E}(x) = 2, \quad \mathbb{E}(y) = 0
$$
协方差矩阵公式：
$$
\Gamma_{xx} = \mathbb{E}\left[(x - \bar{x})(x - \bar{x})^\top\right]
$$

$$
\Gamma_{yy} = \mathbb{E}\left[(y - \bar{y})(y - \bar{y})^\top\right]
$$

$x^2$ 的均值计算：
$$
\mathbb{E}(x^2) = \text{Var}(x) + \mathbb{E}^2(x)
= 1 + 4 = 5
$$
$y$ 的均值：
$$
\mathbb{E}(y) = 10
$$
$x$ 的方差计算：
$$
\Gamma_x = \mathbb{E}[(x - 2)^2] = \mathbb{E}[x^2] - 4\mathbb{E}(x) + 4 = 5 - 4 = 1
$$

```matlab
clear all;clc;
n = 1000; % 定义点的数量为1000

e = randn(1,n);   % 生成高斯白噪声（1000个点）

x = 2 + randn(1,n);  % 生成以2为中心的随机变量x
y = 2*x.^2 + e;  % 计算目标变量y，非线性关系 2x^2 + 噪声

x_chap = x - mean(x); % 将x去中心化，使其均值为0
y_chap = y - mean(y); % 将y去中心化，使其均值为0

figure;
plot(x_chap,y_chap,'*')  % 绘制去中心化处理后的数据对 (x_chap, y_chap) 的分布图
xlabel('$\hat{x}$ (centered x)', 'Interpreter', 'latex');
ylabel('$\hat{y}$ (centered y)', 'Interpreter', 'latex');
title('Scatter plot of $\hat{y}$ versus $\hat{x}$', 'Interpreter', 'latex');


mean_x=mean(x); % 计算x的均值
mean_y=mean(y); % 计算y的均值
mean_x_chap  =mean(x_chap.^2); % 计算x去中心化后的平方均值（方差）
mean_y_chap  =mean(y_chap.^2); % 计算y去中心化后的平方均值（方差）
mean_xy_chap =mean(x_chap.*y_chap);   % 计算x去中心化和y去中心化的协方差

% 打印各统计值
fprintf('Mean of x: %f\n', mean_x); % 打印x的均值
fprintf('Mean of y: %f\n', mean_y); % 打印y的均值
fprintf('Mean of x_chap^2: %f\n', mean_x_chap); % 打印x去中心化平方的均值
fprintf('Mean of y_chap^2: %f\n', mean_y_chap); % 打印y去中心化平方的均值
fprintf('Mean of x_chap * y_chap: %f\n', mean_xy_chap); % 打印x去中心化和y去中心化的协方差
```

![exo_1_1](/Users/zehua/Documents/GitHub/Zehua716.github.io/static/img/kalman/exo_1_1.png)

显示**抛物线加噪声** 的特征分布，这是由于原始的二次关系 $ y = 2x^2 + e $。去中心化之后，数据的分布没有改变其非线性特征，这说明数据的中心平移操作并不影响变量之间的关系。



Ex 2

计算随机矩阵 A 的协方差矩阵 $S1 = A \times A' $ ；

使用特征值分解对协方差矩阵进行处理，并重新构造矩阵 S2 ；

通过平方根矩阵的概念，进一步构造矩阵 S3 。



```matlab
 %特征值的分解和特征向量的计算
clear all;clc;
A = rand(3,3);
S1 = A * A';
[R,D] = eig(S1);%对矩阵 S1 进行特征值分解，其中 R 是包含 S1 的特征向量的矩阵，而 D 是对角矩阵，其对角线上的元素是对应的特征值。
S2 = R * D * R';%使用特征向量和特征值重构矩阵 S1，确保 S2 与 S1 相同.....正交矩阵（R），逆矩阵等于转置矩阵。
A2 = sqrtm(S2);%这行代码计算矩阵 S2 的平方根，即找到一个矩阵 A2，使得 A2 * A2' = S2
S3 = A2 * A2';%验证 A2 是否确实是 S2 的平方根
```

A是随机生成的，不具有数学特性，A2是计算得到的平方根，因为S1 和S2都是对称、正定矩阵(由矩阵乘其转置生成)，所以其实A2也是一个对称矩阵

 对 S1 的分解得到 $\Gamma = R \cdot D \cdot R^{-1}$ ，其中 D 是对角矩阵，包含 S1 的特征值，R 是正交矩阵，包含矩阵 S1 的特征向量

 S1, S2, S3 是相同的矩阵（由于 S2, S3 是由 S1 的特征值和分解重构得到的）。

$A \neq A2$ ：因为 A 是随机的，而 A2 是对称的。

得到结果如下:
$$
A = \begin{bmatrix}
0.7502 & 0.3628 & 0.3314 \\\\
0.0787 & 0.7970 & 0.9500 \\\\
0.8680 & 0.7864 & 0.8285
\end{bmatrix} \quad \quad \quad \quad A2 = \begin{bmatrix}
0.5627 & 0.1330 & 0.6855 \\\\
0.1330 & 1.0476 & 0.6547 \\\\
0.6855 & 0.6547 & 1.0768
\end{bmatrix}
$$

$$
S1 = \begin{bmatrix}
0.8042 & 0.6630 & 1.2110 \\\\
0.6630 & 1.5439 & 1.4822 \\\\
1.2110 & 1.4822 & 2.0581
\end{bmatrix} \quad S2 = \begin{bmatrix}
0.8042 & 0.6630 & 1.2110 \\\\
0.6630 & 1.5439 & 1.4822 \\\\
1.2110 & 1.4822 & 2.0581
\end{bmatrix}\quad S3 = \begin{bmatrix}
0.8042 & 0.6630 & 1.2110 \\\\
0.6630 & 1.5439 & 1.4822 \\\\
1.2110 & 1.4822 & 2.0581
\end{bmatrix}
$$


EX3

**从标准正态分布生成二维数据点，并将这些数据通过一个线性变换和偏移得到新的分布数据点，然后可视化其分布特性**

