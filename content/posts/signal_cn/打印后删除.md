L'objectif de VAE est de maximiser $ P(x)$

Pour simplifier les calculs, prenez le logarithme $\log P(X)$  
$$
\log P(X) = \log \int P(X, Z) \, dZ
$$
En raison de la difficulté  à résoudre, on introduite une distribution auxiliaire Q(Z|X) 
$$
\log P(X) = \log \int P(X, Z) \frac{Q(Z)}{Q(Z)} \, dZ
$$

$$
\log P(X) = \log \mathbb{E}_{Q(Z)} \left[ \frac{P(X, Z)}{Q(Z)} \right]
$$

Faire passer $\log $ à travers l'intégrale, à travers l'espérance:



Selon l'inégalité de Jensen, pour une fonction convexe f(x) et une variable aléatoire X, on a :
$$
f(\mathbb{E}[X]) \leq \mathbb{E}[f(X)]
$$
$\log$ est une fonction concave, donc
$$
\log \mathbb{E}[f(Z)] \geq \mathbb{E}[\log f(Z)]
$$

$$
\log P(X) = \log \mathbb{E}_{Q(Z)}\left[\frac{P(X, Z)}{Q(Z)}\right] \geq \mathbb{E}_{Q(Z)}\left[\log \frac{P(X, Z)}{Q(Z)}\right]
$$

Inférence variationnelle:
$$
\log P(X) = \mathcal{L}(Q) + \mathcal{D}(Q(Z) \| P(Z|X))
$$

$$
D_{KL}(Q(Z) \| P(Z|X)) = \mathbb{E}_{Q(Z)} \left[ \log \frac{Q(Z)}{P(Z|X)} \right]
$$

Preuve::
$$
\begin{align*}
\log P(X) &= \mathbb{E}_{Q(Z)} \log P(X) \\
&= \mathbb{E}_{Q(Z)} \log \frac{P(X, Z)}{P(Z \mid X)} \\
&= \mathbb{E}_{Q(Z)} \log \frac{P(X, Z) Q(Z)}{P(Z \mid X) Q(Z)} \\
&= \mathbb{E}_{Q(Z)} \log \frac{P(X, Z)}{Q(Z)} + \mathbb{E}_{Q(Z)} \log \frac{Q(Z)}{P(Z \mid X)} \\
&= \mathbb{E}_{Q(Z)} \log \frac{P(X, Z)}{Q(Z)} + D\big[Q(Z) \| P(Z \mid X)\big]\\

&= \mathcal{L}(Q) + D_{KL}(Q(Z) \| P(Z|X))
\end{align*}
$$




